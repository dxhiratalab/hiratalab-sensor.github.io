<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>空きセンサー確認</title>
</head>
<body>
    <h1>空きセンサー一覧</h1>
    <button onclick="updateSensorStatus()">更新</button>
    <p id="status">状態: 未取得</p>
    <pre id="sensorData"></pre>

    <script src="sensorManager.js"></script>
    <script>
        const manager = new SensorManager('https://script.google.com/macros/s/AKfycbybFSu-65PGxJickvD0xNabGHTQZPXVaf9ysxZZs0SqXnpKg4yzUUbexww2whtymudW/exec');

        async function updateSensorStatus() {
            try {
                //const statusElement = document.getElementById('status');
                const dataElement = document.getElementById('sensorData');
                
                //statusElement.textContent = '状態: 取得中...';
                
                // データ取得
                const data = await manager.fetchSensorStatus();
                // console.log(data);
                // 取得したデータの表示
                dataElement.textContent = JSON.stringify(data, null, 2);
                
                // 状態を更新
                statusElement.textContent = `状態: ${manager.getStatus()}`;
                
                // 空きセンサーデータを表示
                const freeSensors = manager.getFreeSensors();
                dataElement.textContent = JSON.stringify(freeSensors, null, 2);
                
                // デバッグ用にコンソールにも出力
                console.log('空きセンサー:', freeSensors);
            } catch (error) {
                console.error('エラー:', error);
                document.getElementById('status').textContent = '状態: エラーが発生しました';
            }
        }
    </script>
</body>
</html>